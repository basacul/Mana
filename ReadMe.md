# Mana
This web application is developed on top of the hyperledger fabric technology stack and will be pursued to finish the prototype for exchanging data securely using distributed ledger technologies.

Mana is a web application for the healthcare system that allows healthcare service providers, patients and insurance companies to securely exchange and manage data in the Mana ecosystem. Mana runs on top of the ethereum network and uses smart contracts to handle the logic on how data is accessed and exchanged based on the authorization given by the data owner. This application gives the patient the tools to retrieve medical data generated by healthcare service providers and manage a holistic electronic healthcare record. The patient can choose what aspects of his or her record to share, that can be withdrawn at any moment.

In addition, Mana allows users to store sensitive data outside of the ethereum network such that this data is not available in the ethereum network. A messaging service for users in the ecosystem allows to communicate with healthcare service providers, insurance companies and other patients.

The goal of Mana is to provide a secure distributed data exchange grid for the healthcare sector by minimizing the investment in new IT infrastructure and providing a tool to accelerate the digital adoption in the healthcare system.

This application uses mongodb, express, nodejs and ethereum. MetaMask - for now - is needed as a wallet to use the features given by the ethereum network. The frontend uses html5, css3 with bootstrap v4.2.0, and finally javascript using jQuery for bootstrap, web3.js injected by MetaMask and vanilla javascript - a fancy name for plain javascript without any additional libraries.

The [synopsis](https://github.com/basacul/Mana/blob/master/documents/Secure_Data_Exchange_Using_Distributed_Ledger_Technologies_Version_0_10.pdf) of my bachelor thesis explains my personal motivation, related systems and works as well as the schedule for this project.

The name for this project will be Mana coming from the Polynesian belief, that Mana is an impersonal supernatural power which can be transmitted or inherited. The first generation prototype will go live on July 31 2019 at [Openhealth](http://openhealth.care).

## Task Schedule
The bachelor thesis starts end of July or at August 1st and takes twelve weeks to complete. The tasks are scheduled along these twelve weeks.


| Task           | Week 1 | Week 2 | Week 3 | Week 4 | Week 5 | Week 6 |
| -------------- | ------ | ------ | ------ | ------ | ------ | ------ |
| Research       | YES    | YES    | YES    | YES    | no     | no     |
| Analysis       | no     | YES    | YES    | YES    | YES    | YES    |
| Design Concept | no     | no     | YES    | YES    | YES    | YES    |
| Implementation | no     | no     | no     | YES    | YES    | YES    |
| Evaluation     | no     | no     | no     | no     | YES    | YES    |
| Writing        | YES    | YES    | YES    | YES    | YES    | YES    |


| Task           | Week 7 | Week 8 | Week 9 | Week 10 | Week 11 | Week 12 |
| -------------- | ------ | ------ | ------ | ------- | ------- | ------- |
| Research       | no     | no     | no     | no      | no      | no      |
| Analysis       | no     | no     | no     | no      | no      | no      |
| Design Concept | YES    | YES    | no     | no      | no      | no      |
| Implementation | YES    | YES    | YES    | YES     | YES     | no      |
| Evaluation     | YES    | no     | YES    | YES     | YES     | no      |
| Writing        | YES    | YES    | YES    | YES     | YES     | YES     |

## Structure
The web application uses ejs to display the following sites that are accessible through the navigation bar at the top starting with the logo from left to right:

* __home.ejs__: *LOGO* Site welcomes the user that is rendered only by clicking the Mana logo
* __e-record.ejs__: *E-Record* Site manages the data available through the ethereum network 
* __tools.ejs__: *Tools* Site manages the settings concerning the ethereum network
* __account.ejs__: *My Account* Site manage the account settings concerning the web application
* __messages.ejs__: *Messages* Site providing the messaging service
* __personal.ejs__: *Personal* Site manages data stored outside the ethereum network
* __contact.ejs__: *Help/Contact Us* Site with contact information and form
* __faq.ejs__: *Help/FAQ* Site with faq
* __documentation.ejs__: *Help/Documentation* Site with documentation for the web application
* __login.ejs__: *Checkout* Logs the user out and sends the user back to the login page

This web application currently in version 4.0.0 is under construction and will be live on July 31 2019 at [Openhealth.care](http://openhealth.care/). In MetaMask choose Rinkeby as network where the smart contracts are deployed and tested.

## How to use

Please make sure, that you have Node.js istalled on your system, which you can download at their site [Node.js](https://nodejs.org/en/download/). With Node.js istalled you automatically have access to the command __npm__. This web app runs and is tested on nodejs version 12.2.0.

If __git__ is not available on your system, you can download this repository as a zip file and unpack it on your system. In the *terminal*/*command line* go to ../../../Mana/dapp and run __node app.js__.  Otherwise clone the repository with git.

Check app.js to see how the web application is currently organized and the separate ejs sites, as it is still simple for now. By following this steps you can already test the application on your local machine at localhost:3000 for which you need to have the [MetaMask](https://metamask.io/) extension installed on your browser. Do not forget to set MetaMask to Rinkeby network.

Make sure you have mongodb installed and set the environment variables. In my setting, I installed mongodb community version on Windows 10 with the default settings and created a bat file that allows me to start the database manually called StartMongo.bat.

```bat
@echo off
cd "C:\mongodb\bin"
start mongod.exe
timeout 3
start mongo.exe
exit
```

In order to use the prototype:

```
Install node.js before running this commands
> git clone https://github.com/basacul/Mana.git
> cd Mana
> npm install
> npm run start
// if you want to develop without having to restart the server all the time
// make sure to have nodemon installed
// > npm install nodemon // if you do not have nodemon installed
// > npm run dev
```